<div id="frmInfo" class="form">
    <div id="tabContent" class="mini-tabs" activeindex="0" style="width: 100%; height: 580px;" plain="true">
        <div title="苏州铁塔公司零星用工派工单" style="height:100%">
            <input class="mini-hidden" id="Id" name="Id" />
            <table style="width:100%">
                <tr>
                    <td colspan="4" align="center" style="font-size:11pt;">
                        <b>
                            @if (@ViewData["OrderCode"].ToString() == "")
                            {
                                @:苏州铁塔公司零星用工派工单
                        }
                            else
                            {
                                @:苏州铁塔公司零星用工派工单(@ViewData["OrderCode"])
                        }
                        </b>
                    </td>
                </tr>
            </table>
            <fieldset>
                <legend><b>派工单</b></legend>
                <table class="table" cellpadding="0" cellspacing="0" style="margin: auto; width: 900px">
                    <tr>
                        <td style="width:100px;" align="right">派工人</td>
                        <td style="width:300px;" align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["FullName"]" /></td>
                        <td style="width:100px;" align="right">派工日期</td>
                        <td style="width:300px;" align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["CreateDate"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">标题</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["Title"]" /></td>
                        <td align="right">网格</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["ReseauName"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">工单类型</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["ClassName"]" /></td>
                        <td align="right">要求派工日期</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["RequireSendDate"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">现场联系人</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["SceneContactMan"]" /></td>
                        <td align="right">现场联系电话</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["SceneContactTel"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">派工单位</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["CustomerName"]" /></td>
                        <td align="right">派工时长</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["Days"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">派工联系人</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["MaintainContactMan"]" /></td>
                        <td align="right">派工联系电话</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["MainTainContactTel"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">工作内容</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["WorkContent"]" /></td>
                        <td align="right">用人要求</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["HumanRequire"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">用车要求</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["CarRequire"]" /></td>
                        <td align="right">材料要求</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["MaterialRequire"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">附件</td>
                        <td colspan="3">
                            <table>
                                <tr>
                                    <td style="width:16px">
                                        <a class="fileedit" onclick="onFileClick();"></a>
                                    </td>
                                    <td>
                                        附件数量：<input id="Count" name="Count" class="mini-textbox" value="@ViewData["Count"]" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <legend><b>结算单</b></legend>
                <table class="table" cellpadding="0" cellspacing="0" style="margin: auto; width: 900px">
                    <tr>
                        <td style="width:100px;" align="right">工作起始时间</td>
                        <td style="width:300px;" align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["WorkBeginDate"]" /></td>
                        <td style="width:100px;" align="right">工作结束时间</td>
                        <td style="width:300px;" align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["WorkEndDate"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">执行情况</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["ExecuteSituation"]" /></td>
                        <td align="right">材料消耗</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["MaterialConsumption"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">人员数量</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["PersonnelNumber"]" /></td>
                        <td align="right">车辆类型</td>
                        <td align="left"><input id="DepartmentName" class="mini-textarea" style="width: 200px;" readonly="true" value="@ViewData["CarType"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">是否完成</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["IsFinish"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">结算登记人</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["RegisterFullName"]" /></td>
                        <td align="right">结算登记日期</td>
                        <td align="left"><input id="DepartmentName" class="mini-textbox" style="width: 200px;" readonly="true" value="@ViewData["RegisterDate"]" /></td>
                    </tr>
                    <tr>
                        <td align="right">附件</td>
                        <td colspan="3">
                            <table>
                                <tr>
                                    <td style="width:16px">
                                        <a class="fileedit" onclick="onSettlementFileClick();"></a>
                                    </td>
                                    <td>
                                        附件数量：<input id="SettlementCount" name="SettlementCount" class="mini-textbox" value="@ViewData["SettlementCount"]" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </fieldset>
            <fieldset>
                <legend><b>各天执行情况</b></legend>
                <table class="table" cellpadding="0" cellspacing="0" style="margin: auto; width: 900px">
                    @if (@ViewData["WorkOrderDetailInfoHtml"].ToString() != "")
                    {
                        <tr>
                            <td colspan="4" style="width:1000px;">
                                @Html.Raw(ViewData["WorkOrderDetailInfoHtml"])
                            </td>
                        </tr>
                    }
                </table>
            </fieldset>
            <fieldset>
                <legend><b>审批信息</b></legend>
                <table class="table" cellpadding="0" cellspacing="0" style="margin: auto; width: 900px">
                    @if (@ViewData["WFActivityInstancesInfoHtml"].ToString() != "")
                    {
                        <tr>
                            <td colspan="8" style="width:1000px;">
                                @Html.Raw(ViewData["WFActivityInstancesInfoHtml"])
                            </td>
                        </tr>
                    }
                </table>
            </fieldset>
        </div>
    </div>
</div>
<script type="text/javascript">
    mini.parse();

    var count = mini.get("Count");
    count.setWidth("10px");
    if (count.setReadOnly) count.setReadOnly(true);     //只读
    if (count.setIsValid) count.setIsValid(true);      //去除错误提示
    if (count.addCls) count.addCls("asLabel");          //增加asLabel外观

    var settlementCount = mini.get("SettlementCount");
    settlementCount.setWidth("10px");
    if (settlementCount.setReadOnly) settlementCount.setReadOnly(true);     //只读
    if (settlementCount.setIsValid) settlementCount.setIsValid(true);      //去除错误提示
    if (settlementCount.addCls) settlementCount.addCls("asLabel");          //增加asLabel外观

    function onFileClick() {
        var el = document.body;
        mini.mask({
            el: el,
            cls: 'mini-mask-loading',
            html: '加载中...'
        });
        setTimeout(function () {
            $.ajax({
                url: "@Url.RouteUrl(new { controller = "File", action = "GetWorkOrderFiles" })",
                data: { Id: "@ViewData["Id"]", FileIdList: "" },
                type: "get",
                async: false,
                success: function (result, textStatus) {
                    mini.unmask(el);
                    if (result.Code == null || !result.Code) {
                        mini.open({
                            url: "@Url.RouteUrl(new { controller = "File", action = "FileManager" })",
                            title: "附件",
                            iconCls: "icon-file",
                            width: 620,
                            height: 250,
                            allowResize: false,
                            onload: function () {
                                var iframe = this.getIFrameEl();
                                var data = result;
                                iframe.contentWindow.SetData(data);
                            }
                        });
                    }
                },
                error: function (xmlHttpRequest, textStatus, errorThrown) {
                    mini.unmask(el);
                }
            });
        }, 50);
    }

    function onSettlementFileClick() {
        var el = document.body;
        mini.mask({
            el: el,
            cls: 'mini-mask-loading',
            html: '加载中...'
        });
        setTimeout(function () {
            $.ajax({
                url: "@Url.RouteUrl(new { controller = "File", action = "GetWorkOrderWFFiles" })",
                data: { Id: "@ViewData["Id"]", FileIdList: "" },
                type: "get",
                async: false,
                success: function (result, textStatus) {
                    mini.unmask(el);
                    if (result.Code == null || !result.Code) {
                        mini.open({
                            url: "@Url.RouteUrl(new { controller = "File", action = "FileManager" })",
                            title: "附件",
                            iconCls: "icon-file",
                            width: 620,
                            height: 250,
                            allowResize: false,
                            onload: function () {
                                var iframe = this.getIFrameEl();
                                var data = result;
                                iframe.contentWindow.SetData(data);
                            }
                        });
                    }
                },
                error: function (xmlHttpRequest, textStatus, errorThrown) {
                    mini.unmask(el);
                }
            });
        }, 50);
    }
</script>